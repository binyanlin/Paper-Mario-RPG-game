<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>RPG Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"/>
    <link rel="stylesheet" href="./assets/css/style.css"/>
</head>
<body>

    <div class="title">
        <h1 class="text-center">Paper Mario RPG</h1>
    </div>

    <div class="startingArea">
        <div class="row">
            <button type="button" class="char char1 col-sm btn" id="A">
                    <img src="./assets/images/goomba.png"/>
                    <p>HP: <span class="charHp" >90</span></p>
            </button>
            <button type="button" class="char char2 col-sm btn B" id="B">
                    <img src="./assets/images/bob-omb.png"/>
                    <p>HP: <span class="charHp">60</span></p>
            </button>
            <button type="button" class="char char3 col-sm btn C" id="C">
                    <img src="./assets/images/paratroopa.png"/>
                    <p>HP: <span class="charHp">120</span></p>
            </button>    
            <button type="button" class="char char4 col-sm btn D" id="D">
                    <img src="./assets/images/piranha.png"/>
                    <p>HP: <span class="charHp">75</span></p>
            </button>
        </div>
    </div>

    <!-- for you win, select your character, etc  -->
    <div><h1 class="comment text-center">Select Character to Start!</h1></div>

    
    <div class="row">
        <div class="col-sm ml-3">
            <h2>Your Character</h2>
            <div class="yourCharacter bg-success rounded-circle"></div>
        </div>
        <div class="col-sm">
            <h2>Defender</h2>
            <div class="defender bg-danger rounded-circle"></div>
        </div>
        <div class="col-sm">
            <h2>Enemies Left</h2>
            <div class="enemyField bg-warning rounded-circle"></div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-1 attackButtonPlace">
        </div>
        <div class="col-sm-6 attackLogPlace"></div>
        <div class="col-sm-4 spacer"></div>
    </div>

    <script>
    //variables

    //hp of the 4 characters
    let hpA = 90;
    let hpB = 60;
    let hpC = 120;
    let hpD = 75;

    let playerHp;
    let enemyHP;
    
    // const attackButton = "<button type="button" class="btn bg-secondary text-light">Attack!</button>"
    var attackButton = `<button type="button" class="btn text-light bg-secondary attackB" id="attackB">Attack!</button>`

    charPick = false;
    enemyPick = false;
    let attackGrowth;
    let baseAttackPower;
    let counterAttack;
    let attackCounter = 0;

    // each turn:                     
    let baseAttackPowerList = {A: 8, B: 14, C: 2, D: 6};
    let attackGrowthList = {A: 6, B: 14, C: 4, D: 10};
    let counterAttackList = {A: 8, B: 10, C: 5, D: 8};
    // object of objects:
    let charData = {baseAttackPowerList, attackGrowthList, counterAttackList}

    const damageAssigner = function() {
        if (playerId == "A") {
            baseAttackPower = baseAttackPowerList.A;
            attackGrowth = attackGrowthList.A;
        } else if (playerId == "B") {
            baseAttackPower = baseAttackPowerList.B;
            attackGrowth = attackGrowthList.B;  
        } else if (playerId == "C") {
            baseAttackPower = baseAttackPowerList.C;
            attackGrowth = attackGrowthList.C;
        } else if (playerId == "D") {
            baseAttackPower = baseAttackPowerList.D;
            attackGrowth = attackGrowthList.D;
        };

        if (enemyId == "A") {
            counterAttack = counterAttackList.A;
        } else if (enemyId == "B") {
            counterAttack = counterAttackList.B;
        } else if (enemyId == "C") {
            counterAttack = counterAttackList.C;
        } else if (enemyId == "D") {
            counterAttack = counterAttackList.D;
        };
        console.log("baseAttackPower: ", baseAttackPower, "attackGrowth: ", attackGrowth, "counterAttack: ", counterAttack);
    };
    // //gamestart
    // // onclick function for char selection, moves selected char to main character, moves other 3 to enemy
    $(".char").on("click", function() {
        // if no character in "your character" division
        if (charPick === false && enemyPick === false) {
            $(this).removeClass("char").addClass("mainChar");
            // moves chosen char to main char, moves others to enemy char
            $(".yourCharacter").append($(this));
            $(".enemyField").append($(".char"));
            // assign HP to playerHp, assign stats from object
            $(this).removeClass("charHp").addClass("playerHp");
            playerHp = $(".playerHp").text();
            playerHp = parseInt(playerHp.replace(/[^\d]/g, ''));
            playerId = $(this).attr("id");
            // display next step
            $(".comment").text("Select your first opponent")
            charPick = true;
        // moves enemy to defender and assigns enemyHp
        } else if (charPick === true && enemyPick === false && $(this).hasClass("char")) {  //note: last "and" is to remove edge case of putting main character into defender category
            $(this).removeClass("char").addClass("currentEnemy");
            $(".defender").append($(".currentEnemy"));
            // assign defender's hp as enemyHP
            $(this).removeClass("charHp").addClass("enemyHp");
            enemyHp = $(".enemyHp").text();
            enemyHp = parseInt(enemyHp.replace(/[^\d]/g, ''));
            enemyId = $(this).attr("id");
            // allows for attack to begin
            $(".comment").text("Begin Fight!");
            damageAssigner();
            enemyPick = true;
            $(".attackButtonPlace").html(attackButton);
        // } else if (charPick === true && enemyPick === false) {
        //     $(".char").off("click");
        };
    }); 


    // // TestVariables
    // // $(".attackButtonPlace").append(attackButton);
    // baseAttackPower = 2;
    // attackGrowth = 3;
    // counterAttack = 4;
    // enemyHp = 60;
    // playerHp = 90;
    const enemyHpCheck = function() {
        if (enemyHp > 0) {
            $(".enemyHp").find(".charHp").text(enemyHp);
            playerHp -= counterAttack;
        } else if (enemyHp <= 0) {
            $(".enemyHp").find(".charHp").text("0");
            $(".comment").text("Enemy fainted!")
            enemyPick = false;
            setTimeout(function() { 
                $(".enemyHp").remove();
            }, 2000);
            setTimeout(function() { 
                $("attackB").remove();
            }, 2000);
            setTimeout(function() { 
                $(".comment").text("Select New Opponent");
            }, 3000);
        };
    };

    const playerHpCheck = function() {
        if (playerHp > 0) {
            $(".playerHp").find(".charHp").text(playerHp);
        } else if (playerHp <= 0) {
            $(".enemyHp").find(".charHp").text("0");
            setTimeout(function() { 
                $(".comment").text("You Lose!");
            }, 2000);
            // some sort of retry button
        };
    };

    // once attack button has appeared:
    $(document).on("click", ".attackB", function() {
            let attackDamage = baseAttackPower + attackCounter*attackGrowth;
            if (enemyHp > 0) {
                enemyHp -= attackDamage;
                enemyHpCheck();
                attackCounter++;
                playerHpCheck();
            };
        });
    
   
        // enemyHpCheck();
        // textUpdate();
        //     if (isEnemy()) {
        //         playerHp -= counterAttack;
        //         gameOverCheck();
        //         textUpdate();
        //     } else {
                // assign a new enemy character
                // if no enemy chars are left then display you win
    // });


   

    // variables for checking state of the game
    // gameOverCheck: checks if your character hp = 0, if so displays game over and restart button
    // isEnemy: checks if there is an enemy inside the enemy div, otherwise displays "no target"
    // enemyHPCheck: checks if enemy HP is 0, removes them from enemy slot if so
    // var textUpdate for updating all the text

    
    
    
    
    </script>


</body>
</html>